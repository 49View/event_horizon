name: Docker Image CI

on: [push]

jobs:

  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    
    - uses: azure/docker-login@v1
      with:
        username: ${{ secrets.DOCKER_HUB_ID }}
        password: ${{ secrets.docker_hub_pass }}
        
    - name: Build NGINX
      run: docker build -t ateventhorizon/49view-nginx ./nginx      
    - name: Build restful-api
      run: docker build -t ateventhorizon/49view-restful-api ./restful-api
    - name: Build portal
      run: docker build -t ateventhorizon/49view-portal ./portal
    - name: Build rsinitiate
      run: docker build -t ateventhorizon/49view-mongo-rsinitiate ./mongo
      
#     - name: Docker hub login
#       run: echo ${{ secrets.DOCKER_HUB_PWD }} | docker login -u ${{ secrets.DOCKER_HUB_ID }} --password-stdin

    - name: Docker Push NGINX
      run: docker push ateventhorizon/49view-nginx
    - name: Docker Push restful-api
      run: push ateventhorizon/49view-restful-api
    - name: Docker Push portal
      run: push ateventhorizon/49view-portal
    - name: Docker Push rsinitiate
      run: push ateventhorizon/49view-mongo-rsinitiate

