<html>
	<head>
		<title>Event Horizon</title>
		<style>
			html, body
			{
			  height: 100%;
			  margin: 0;
			}
			body
			{
			  display: flex;
			  display: -webkit-flex;
			  -webkit-justify-content: center;
					  justify-content: center;
			  -webkit-align-items: center;
					  align-items: center;  
			}
			#logger {
				display: block;
				width: 100%;
				height: 100px;
			}
			canvas#display
			{
			  background-color: black;
			  display: block;
			  outline: none;
			  height: 100%;
			  width: 100%;
			}
		</style>
		<link rel="shortcut icon" type="image/png" href="/favicon.png"/>
	</head>
	<body>	
		<canvas id="display"></canvas>
		<script>
			var Module = {
				print: function(text) {
					console.log(text);
					//var element=document.getElementById('logger');
					//element.value=element.value+text+'\n';
				},
				printErr: function(text) {
					console.log("ERROR: "+text);
				},
				canvas: (function() {
					var canvas = document.getElementById('display');
					return canvas;
				})(),
			};


			function downloadWasm(url) {
				return new Promise(function(resolve, reject) {
					var wasmXHR = new XMLHttpRequest();
					wasmXHR.open('GET', url, true);
					wasmXHR.responseType = 'arraybuffer';
					wasmXHR.onload = function() { resolve(wasmXHR.response); }
					wasmXHR.onerror = function() { reject('error '  + wasmXHR.status); }
					wasmXHR.send(null);
				});
			}

			var url = "editor.wasm";
			var wasm = downloadWasm(url);
		
			
			Module.instantiateWasm = function(imports, successCallback) {
				console.log('instantiateWasm: instantiating asynchronously');
				wasm.then(function(wasmBinary) {
					console.log('wasm download finished, begin instantiating');
					var wasmInstantiate = WebAssembly.instantiate(new Uint8Array(wasmBinary), imports).then(function(output) {
						console.log('wasm instantiation succeeded');
						Module.testWasmInstantiationSucceeded = 1;
						successCallback(output.instance);
					}).catch(function(e) {
						console.log('wasm instantiation failed! ' + e);
					});
				});
				return {}; // Compiling asynchronously, no exports.
			}
			
			
		</script>
		<script async type="text/javascript" src="editor.js"></script>
	</body>
</html>